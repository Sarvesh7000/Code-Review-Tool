rules:
  # ==========================================
  # JAVA SPECIFIC RULES
  # ==========================================

  # Rule 1: Use .equals() for String Comparison
  - id: java-rule-1-string-equals
    pattern: $STR1 == $STR2
    message: "Rule 1: Use .equals() for string comparison, not =="
    languages: [java]
    severity: ERROR
    metadata:
      category: best-practice
      rule: "Java Rule 1"

  # Rule 2: Avoid Using System.out.println in Production
  - id: java-rule-2-no-system-out
    pattern-either:
      - pattern: System.out.println(...)
      - pattern: System.err.println(...)
    message: "Rule 2: Avoid System.out.println in production. Use proper logging framework (log4j, slf4j)"
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "Java Rule 2"

  # Rule 3: Always Handle Exceptions Properly
  - id: java-rule-3-handle-exceptions
    pattern: |
      catch (Exception $E) {
        System.out.println($E);
      }
    message: "Rule 3: Handle exceptions properly. Use logger.error() instead of System.out"
    languages: [java]
    severity: WARNING
    metadata:
      category: error-handling
      rule: "Java Rule 3"

  # Rule 4: Do Not Leave Empty Catch Blocks
  - id: java-rule-4-empty-catch
    pattern: |
      try {
        ...
      } catch (Exception $E) {
      }
    message: "Rule 4: Do not leave empty catch blocks. Log or rethrow exceptions"
    languages: [java]
    severity: ERROR
    metadata:
      category: error-handling
      rule: "Java Rule 4"

  # Rule 6: Prefer Interfaces Over Implementations
  - id: java-rule-6-use-interface
    pattern-either:
      - pattern: ArrayList $VAR = new ArrayList(...)
      - pattern: HashMap $VAR = new HashMap(...)
      - pattern: HashSet $VAR = new HashSet(...)
    message: "Rule 6: Use interface types (List, Map, Set) instead of concrete implementations"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Java Rule 6"

  # Rule 7: Keep Fields Private
  - id: java-rule-7-private-fields
    pattern: public $TYPE $FIELD;
    message: "Rule 7: Keep fields private. Use getters/setters for access"
    languages: [java]
    severity: WARNING
    metadata:
      category: encapsulation
      rule: "Java Rule 7"

  # Rule 11: Avoid Catching Generic Exception
  - id: java-rule-11-generic-exception
    pattern: catch (Exception $E)
    message: "Rule 11: Avoid catching generic Exception. Catch specific exceptions"
    languages: [java]
    severity: WARNING
    metadata:
      category: error-handling
      rule: "Java Rule 11"

  # Rule 14: Avoid String Concatenation in Loops
  - id: java-rule-14-string-concat-loop
    pattern: |
      for (...) {
        $STR = $STR + $X;
      }
    message: "Rule 14: Use StringBuilder for string concatenation in loops"
    languages: [java]
    severity: WARNING
    metadata:
      category: performance
      rule: "Java Rule 14"

  # Rule 15: Use PreparedStatement for SQL
  - id: java-rule-15-sql-injection
    pattern: |
      Statement $STMT = ...;
      $STMT.execute("... " + $VAR + " ...");
    message: "Rule 15: Use PreparedStatement to prevent SQL injection"
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-89
      rule: "Java Rule 15"

  # Rule 19: Avoid Thread.sleep() in Loops
  - id: java-rule-19-sleep-in-loop
    pattern: |
      while (...) {
        Thread.sleep(...);
      }
    message: "Rule 19: Avoid Thread.sleep() in loops. Use ScheduledExecutorService"
    languages: [java]
    severity: WARNING
    metadata:
      category: concurrency
      rule: "Java Rule 19"

  # Null Pointer Risk
  - id: java-null-check-missing
    pattern: |
      if ($OBJ != null) {
        $OBJ.$METHOD(...);
      }
      $OBJ.$METHOD2(...);
    message: "Potential null pointer exception. Check for null before use"
    languages: [java]
    severity: WARNING
    metadata:
      category: null-safety

  # Resource Leak
  - id: java-resource-leak
    pattern: |
      $RES = new FileInputStream(...);
    message: "Resource may not be closed. Use try-with-resources"
    languages: [java]
    severity: WARNING
    metadata:
      category: resource-management

  # Weak Hashing
  - id: java-weak-hash
    pattern-either:
      - pattern: MessageDigest.getInstance("MD5")
      - pattern: MessageDigest.getInstance("SHA1")
    message: "MD5 and SHA1 are weak. Use SHA-256 or stronger"
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-327